{% extends "base.html" %}
{% block title %}Cocina 360 — Recetas{% endblock %}

{% block content %}
<form method="get" action="{% url 'recipe_list' %}" class="search-form">
    <input type="text" name="ingredient" placeholder="Search by ingredient" value="{{ ingredient_query }}">
    <input type="number" step="0.1" min="0" name="max_time" placeholder="Max preparation time (min)" value="{{ max_time }}">
    <button type="submit">Search</button>
    {% if ingredient_query or max_time %}
        <a href="{% url 'recipe_list' %}" class="clear-filters">Clear filters</a>
    {% endif %}
</form>

<ul>
    {% for recipe in recipes %}
        <li>
            <a href="{% url 'recipe_detail' pk=recipe.pk %}" class="recipe-link">{{ recipe.name }}</a>
            {% if user.is_authenticated %}
                <form action="{% url 'toggle_favorite' pk=recipe.pk %}" method="post" class="favorite-form" title="Toggle Favorite">
                    {% csrf_token %}
                    {% if recipe.pk in favorite_recipe_ids %}
                        <button type="submit" class="favorite-btn favorited" aria-label="Remove from favorites">♥</button>
                    {% else %}
                        <button type="submit" class="favorite-btn" aria-label="Add to favorites">♡</button>
                    {% endif %}
                </form>
            {% endif %}
        </li>
    {% empty %}
        <li>No recipes found.</li>
    {% endfor %}
</ul>
{% endblock %}
